{{!
    This file is part of Moodle - http://moodle.org/

    Moodle is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Moodle is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Moodle.  If not, see <http://www.gnu.org/licenses/>.
}}
{{!
    @template local_conocer/candidate_dashboard

    Candidate dashboard template for the CONOCER certification system.

    Classes required for JS:
    * none

    Data attributes required for JS:
    * none

    Context variables required for this template:
    * certifications - Array of certification objects the candidate is enrolled in
    * has_certifications - Boolean indicating if the candidate has any certifications
    * pending_evaluations - Number of pending evaluations
    * completed_certifications - Number of completed certifications
    * in_progress_certifications - Number of certifications in progress
    * available_standards - Array of standards available for registration
    * has_available_standards - Boolean indicating if there are standards available

    Example context (json):
    {
        "certifications": [
            {
                "id": 1,
                "standard_name": "EC0217: Impartición de cursos de formación del capital humano de manera presencial grupal",
                "status": "in_progress",
                "progress_percentage": 45,
                "next_step": "Preparación para evaluación diagnóstica",
                "last_updated": "12/02/2023",
                "evaluator_name": "Juan Pérez González"
            }
        ],
        "has_certifications": true,
        "pending_evaluations": 2,
        "completed_certifications": 1,
        "in_progress_certifications": 2,
        "available_standards": [
            {
                "id": 2,
                "standard_code": "EC0301",
                "standard_name": "Diseño de cursos de formación del capital humano de manera presencial grupal, sus instrumentos de evaluación y manuales del curso"
            }
        ],
        "has_available_standards": true
    }
}}

<div class="local-conocer-candidate-dashboard">
    <div class="dashboard-header">
        <h2>{{#str}}candidate_dashboard_title, local_conocer{{/str}}</h2>
        <p class="dashboard-welcome">{{#str}}candidate_dashboard_welcome, local_conocer{{/str}}</p>
    </div>

    <div class="dashboard-stats">
        <div class="stat-box">
            <span class="stat-number">{{pending_evaluations}}</span>
            <span class="stat-label">{{#str}}pending_evaluations, local_conocer{{/str}}</span>
        </div>
        <div class="stat-box">
            <span class="stat-number">{{completed_certifications}}</span>
            <span class="stat-label">{{#str}}completed_certifications, local_conocer{{/str}}</span>
        </div>
        <div class="stat-box">
            <span class="stat-number">{{in_progress_certifications}}</span>
            <span class="stat-label">{{#str}}in_progress_certifications, local_conocer{{/str}}</span>
        </div>
    </div>

    <div class="dashboard-main">
        <div class="dashboard-section">
            <h3>{{#str}}my_certifications, local_conocer{{/str}}</h3>
            
            {{#has_certifications}}
                <div class="certification-list">
                    {{#certifications}}
                        {{> local_conocer/certification_card }}
                    {{/certifications}}
                </div>
            {{/has_certifications}}
            
            {{^has_certifications}}
                <div class="empty-state">
                    <div class="empty-state-icon">
                        <i class="fa fa-certificate" aria-hidden="true"></i>
                    </div>
                    <p>{{#str}}no_certifications_message, local_conocer{{/str}}</p>
                    <a href="{{config.wwwroot}}/local/conocer/available_standards.php" class="btn btn-primary">
                        {{#str}}browse_standards, local_conocer{{/str}}
                    </a>
                </div>
            {{/has_certifications}}
        </div>

        {{#has_available_standards}}
            <div class="dashboard-section">
                <h3>{{#str}}available_standards, local_conocer{{/str}}</h3>
                <div class="available-standards-list">
                    {{#available_standards}}
                        <div class="standard-card">
                            <div class="standard-info">
                                <h4>{{standard_code}}</h4>
                                <p>{{standard_name}}</p>
                            </div>
                            <div class="standard-actions">
                                <a href="{{config.wwwroot}}/local/conocer/register_standard.php?id={{id}}" class="btn btn-outline-primary">
                                    {{#str}}register_standard, local_conocer{{/str}}
                                </a>
                            </div>
                        </div>
                    {{/available_standards}}
                </div>
            </div>
        {{/has_available_standards}}
    </div>

    <div class="dashboard-actions">
        <a href="{{config.wwwroot}}/local/conocer/my_certificates.php" class="btn btn-secondary">
            {{#str}}view_certificates, local_conocer{{/str}}
        </a>
        <a href="{{config.wwwroot}}/local/conocer/profile_settings.php" class="btn btn-secondary">
            {{#str}}profile_settings, local_conocer{{/str}}
        </a>
    </div>
</div>

{{#js}}
require(['jquery', 'local_conocer/candidate_dashboard'], function($, Dashboard) {
    new Dashboard();
});
{{/js}}
